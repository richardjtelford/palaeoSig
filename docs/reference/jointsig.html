<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test if two variables jointly control changes in fossil data — jointsig • palaeoSig</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test if two variables jointly control changes in fossil data — jointsig"><meta name="description" content="Generates synthetic variables with different proportion of two
environmental variables, and tests how much variance in the fossil data
reconstructions of these synthetic variables explain."><meta property="og:description" content="Generates synthetic variables with different proportion of two
environmental variables, and tests how much variance in the fossil data
reconstructions of these synthetic variables explain."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoSig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/h-block-crossvalidation.html">H-block cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/randomTF-spatial.html">randomTF on spatially structured environments</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/richardjtelford/palaeoSig/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Test if two variables jointly control changes in fossil data</h1>
      <small class="dont-index">Source: <a href="https://github.com/richardjtelford/palaeoSig/blob/HEAD/R/jointsig.r" class="external-link"><code>R/jointsig.r</code></a>, <a href="https://github.com/richardjtelford/palaeoSig/blob/HEAD/R/plot.js.R" class="external-link"><code>R/plot.js.R</code></a></small>
      <div class="d-none name"><code>jointsig.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates synthetic variables with different proportion of two
environmental variables, and tests how much variance in the fossil data
reconstructions of these synthetic variables explain.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">jointsig</span><span class="op">(</span><span class="va">spp</span>, <span class="va">fos</span>, <span class="va">var1</span>, <span class="va">var2</span>, method <span class="op">=</span> <span class="st">"randomTF"</span>, n <span class="op">=</span> <span class="fl">99</span>, r <span class="op">=</span> <span class="fl">32</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'js'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">names.v1</span>, <span class="va">names.v2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-spp">spp<a class="anchor" aria-label="anchor" href="#arg-spp"></a></dt>
<dd><p>Data frame of modern training set species data, transformed as
required, for example with sqrt</p></dd>


<dt id="arg-fos">fos<a class="anchor" aria-label="anchor" href="#arg-fos"></a></dt>
<dd><p>Data frame of fossil species data, with same species codes and
transformations as spp</p></dd>


<dt id="arg-var-">var1<a class="anchor" aria-label="anchor" href="#arg-var-"></a></dt>
<dd><p>Training set environmental variable 1</p></dd>


<dt id="arg-var-">var2<a class="anchor" aria-label="anchor" href="#arg-var-"></a></dt>
<dd><p>Training set environmental variable 2</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Which significance test to use.
Current option are randomTF and obs.cor.
The latter may give strange results - use with caution.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of random training sets used to generate the null model</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>How many synthetic variables to make. More is better but slower</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments to plot</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Output from jointsig</p></dd>


<dt id="arg-names-v-">names.v1<a class="anchor" aria-label="anchor" href="#arg-names-v-"></a></dt>
<dd><p>Vector length 2 with names of the end members of the first
environmental variable, e.g., c("cold", "warm") for temperature.</p></dd>


<dt id="arg-names-v-">names.v2<a class="anchor" aria-label="anchor" href="#arg-names-v-"></a></dt>
<dd><p>Ditto for the second variable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components</p>
<dl><dt>PCA</dt>
<dd><p>The unconstrained ordination of the fossil data.</p></dd>

<dt>preds</dt>
<dd><p>A list of the containing the reconstructions for each
environmental variable.</p></dd>

<dt>MAX</dt>
<dd><p>Proportion of the variance explained by the first axis of the
unconstrained ordination. This is the maximum amount that a reconstruction
of a single variable can explain.</p></dd>

<dt>EX</dt>
<dd><p>The proportion of the variance in the fossil data explained by
each reconstruction.</p></dd>

<dt>sim.ex</dt>
<dd><p>The proportion of variance explained by each of the random
environmental variables.</p></dd>

<dt>sig</dt>
<dd><p>The p-value of each reconstruction.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>With <code>method="randomTF"</code>, the function calculates the proportion of
variance in the fossil data explained by transfer function reconstructions of
synthetic variables.
The synthetic variables are composed of two environmental variables, weighted
between -1 and +1, so to represent a circle.
This is compared with a null distribution of the proportion of variance
explained by reconstructions based on random environmental variables.
Any transfer function in the rioja library can be used.
With method="obs.cor", the aim is the same, but the function reports the
correlation between the species weighted average optima on the synthetic
variables and the species first axis scores.
This option has some pathological behaviour and should probably be avoided.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>plot(js)</code>: Plot js object</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Unpublished method - use with caution. Can give spurious results
with weighted averaging.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="randomTF.html">randomTF</a></code>,<code><a href="obs.cor.html">obs.cor</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Richard Telford <a href="mailto:richard.telford@bio.uib.no">richard.telford@bio.uib.no</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.staff.ncl.ac.uk/stephen.juggins/" class="external-link">rioja</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SWAP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">RLGH</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rlgh.js</span> <span class="op">&lt;-</span> <span class="fu">jointsig</span><span class="op">(</span></span></span>
<span class="r-in"><span>  spp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">SWAP</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">RLGH</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  var1 <span class="op">=</span> <span class="va">SWAP</span><span class="op">$</span><span class="va">pH</span>,</span></span>
<span class="r-in"><span>  var2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">SWAP</span><span class="op">$</span><span class="va">pH</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"randomTF"</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">49</span>, r <span class="op">=</span> <span class="fl">32</span>, fun <span class="op">=</span> <span class="va">WA</span>, col <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># nonsense second variable</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rlgh.js</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"acid"</span>, <span class="st">"alkaline"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"down"</span>, <span class="st">"up"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="jointsig-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Telford.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

