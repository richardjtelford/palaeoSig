<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Weighted correlation between weighted averaging optima and constrained
ordination species scores. — obs.cor • palaeoSig</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted correlation between weighted averaging optima and constrained
ordination species scores. — obs.cor"><meta property="og:description" content="obs.cor calculates the weighted correlation between the species
weighted average optima and the axis one species scores of an ordination
constrained by the WA reconstruction."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">palaeoSig</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/h-block-crossvalidation.html">H-block cross-validation</a>
    </li>
    <li>
      <a href="../articles/randomTF-spatial.html">randomTF on spatially structured environments</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/richardjtelford/palaeoSig/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weighted correlation between weighted averaging optima and constrained
ordination species scores.</h1>
    <small class="dont-index">Source: <a href="https://github.com/richardjtelford/palaeoSig/blob/HEAD/R/obs.cor.R" class="external-link"><code>R/obs.cor.R</code></a>, <a href="https://github.com/richardjtelford/palaeoSig/blob/HEAD/R/plot.obscor.R" class="external-link"><code>R/plot.obscor.R</code></a></small>
    <div class="hidden name"><code>obs.cor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>obs.cor calculates the weighted correlation between the species
weighted average optima and the axis one species scores of an ordination
constrained by the WA reconstruction.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">obs.cor</span><span class="op">(</span></span>
<span>  <span class="va">spp</span>,</span>
<span>  <span class="va">env</span>,</span>
<span>  <span class="va">fos</span>,</span>
<span>  ord <span class="op">=</span> <span class="va">rda</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">99</span>,</span>
<span>  min.occur <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">autosim</span>,</span>
<span>  permute <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for obscor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">xlab</span>,</span>
<span>  <span class="va">ylab</span>,</span>
<span>  f <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  which <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  variable_names <span class="op">=</span> <span class="st">"env"</span>,</span>
<span>  abun <span class="op">=</span> <span class="st">"abun.calib"</span>,</span>
<span>  p_val <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for obscor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/identify.html" class="external-link">identify</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">labels</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for obscor</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  which <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  variable_names <span class="op">=</span> <span class="st">"env"</span>,</span>
<span>  abun <span class="op">=</span> <span class="st">"abun.calib"</span>,</span>
<span>  p_val <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  nbins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  top <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spp</dt>
<dd><p>Data frame of modern training set species data, transformed if
required, for example with <code>sqrt</code></p></dd>


<dt>env</dt>
<dd><p>Vector of a single environmental variable</p></dd>


<dt>fos</dt>
<dd><p>Data frame of fossil species data. Species codes and
transformations should match those in spp.</p></dd>


<dt>ord</dt>
<dd><p>Constrained ordination method to use.
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></code> is the default,
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">cca</a></code> should also work.
<code><a href="https://rdrr.io/pkg/vegan/man/capscale.html" class="external-link">capscale</a></code> won't work without modifications to the code
(or a wrapper).</p></dd>


<dt>n</dt>
<dd><p>number of random training sets. More is better.</p></dd>


<dt>min.occur</dt>
<dd><p>Minimum number of occurrences of species in the species and
fossil data.</p></dd>


<dt>autosim</dt>
<dd><p>Optional data frame of random values. This is useful if the
training set is spatially autocorrelated and the supplied data frame contains
autocorrelated random variables.
If <code>autosim</code> is missing, and <code>permute</code> is <code>FALSE</code>, the
transfer functions are trained on random variables drawn from a uniform
distribution.</p></dd>


<dt>permute</dt>
<dd><p>logical value. Generate random environmental variables by
permuting existing variable.
Only possible if there is only one environmental variable and <code>autosim</code>
is missing.</p></dd>


<dt>x</dt>
<dd><p>An obscor object.</p></dd>


<dt>xlab</dt>
<dd><p>X-axis label if the default is unsatisfactory.</p></dd>


<dt>ylab</dt>
<dd><p>Y-axis label if the default is unsatisfactory.</p></dd>


<dt>f</dt>
<dd><p>Scale factor for the abundances, the maximum cex of points for the
which=1 plot.</p></dd>


<dt>which</dt>
<dd><p>Which type of plot. which = 1 gives a plot of RDA scores against
species optima. which = 2 gives a histogram showing the null distribution of
correlations between RDA scores and species optima, together with the
observed correlation.</p></dd>


<dt>variable_names</dt>
<dd><p>Name of environmental variable (only 1 currently) for
the label on the observed correlation with which = 2</p></dd>


<dt>abun</dt>
<dd><p>Which species weighting required for plots. See details</p></dd>


<dt>p_val</dt>
<dd><p>P value to draw a line vertical line at (with which=2)</p></dd>


<dt>...</dt>
<dd><p>Other arguments to plot or identify</p></dd>


<dt>labels</dt>
<dd><p>Labels for the points in identify. By default, the species
names from intersection of colnames(spp) and colnames(fos) are used.</p></dd>


<dt>object</dt>
<dd><p>An obscor object.</p></dd>


<dt>nbins</dt>
<dd><p>integer giving number of bins for the histogram</p></dd>


<dt>top</dt>
<dd><p>Proportion of the figure below the environmental name labels.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>obs.cor returns an obscor object, which is a list</p><ul><li><p>ob Observed correlation. Data.frame with columns Optima, RDA1 and
abun containing the species optima, ordination axis 1 scores, and
abundance used to weight the species respectively and a vector containing
the weighted and unweighted correlations between species optima and
ordination scores.</p></li>
<li><p>sim Matrix with the correlation between species weighted average
optima and ordination scores in the first column and the weighted
correlation in the second column. Each row represents a different random
environmental variable.</p></li>
<li><p>sigs p-value for the observed correlation between species weighted
average optima and ordination scores for each of the weights.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Obs.cor calculates the (weighted) correlation between the species
WA optima in the calibration set and their ordination axis one scores in the
fossil data. Seven different weights for the species are implemented.</p><ul><li><p>"abun.fos" - weight by the mean abundance in the fossil data.</p></li>
<li><p>"abun.calib" - weight by the mean abundance in the calibration data</p></li>
<li><p>"abun.joint" - weight by the product of the mean abundance in the
fossil and calibration data</p></li>
<li><p>"n2.fos" - weight by the effective number of occurrences
(Hill's N2) of each species in the fossil data</p></li>
<li><p>"n2.calib" - weight by the effective number of occurrences
(Hill's N2) of each species in the calibration data</p></li>
<li><p>"n2.joint" - weight by the product of n2.calib and n2.fos</p></li>
<li><p>"unweighted" - all species receive same weight.
This is unlikely to be the best option but is included for completeness.</p></li>
</ul><p>It is unclear which of these weights is likely to be best:
research is in progress.
A square root transformation of the species data is often useful. n = 99
is too small in practice to give a smooth histogram of the null model.
n = 999 is better.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>plot(obscor)</code>: Plots for obscor object</p></li>
<li><p><code>identify(obscor)</code>: Identify species on obs.cor plot</p></li>
<li><p><code>autoplot(obscor)</code>: autoplot for obscor object</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>The test of the weighted correlation between species optima and
ordination axis scores is more powerful, especially with a small number of
fossil observations, that the test of variance explained in
<code><a href="randomTF.html">randomTF</a></code> but is only applicable to WA and will have a large
type II error if there are few species.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Telford, R. J. and Birks, H. J. B. (2011) A novel method for
assessing the statistical significance of quantitative reconstructions
inferred from biotic assemblages. <em>Quaternary Science Reviews</em>
<b>30</b>: 1272--1278.
<a href="https://doi.org/10.1016/j.quascirev.2011.03.002" class="external-link">doi:10.1016/j.quascirev.2011.03.002</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="randomTF.html">randomTF</a></code>, <code><a href="https://rdrr.io/pkg/rioja/man/WA.html" class="external-link">WA</a></code>,
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">cca</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard Telford <a href="mailto:richard.telford@uib.no">richard.telford@uib.no</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.staff.ncl.ac.uk/stephen.juggins/" class="external-link">rioja</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SWAP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">RLGH</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rlgh.obs</span> <span class="op">&lt;-</span> <span class="fu">obs.cor</span><span class="op">(</span></span></span>
<span class="r-in"><span>  spp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">SWAP</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  env <span class="op">=</span> <span class="va">SWAP</span><span class="op">$</span><span class="va">pH</span>,</span></span>
<span class="r-in"><span>  fos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">RLGH</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">49</span> <span class="co"># low number for speed</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rlgh.obs</span><span class="op">$</span><span class="va">sig</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   abun.fos abun.calib abun.joint     n2.fos   n2.calib   n2.joint unweighted </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0.02       0.02       0.02       0.02       0.02       0.02       1.00 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rlgh.obs</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="obs.cor-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rlgh.obs</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="obs.cor-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">rlgh.obs</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="obs.cor-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">rlgh.obs</span>, which <span class="op">=</span> <span class="fl">2</span>, variable_names <span class="op">=</span> <span class="st">"pH"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="obs.cor-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard Telford.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

