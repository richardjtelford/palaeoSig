<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generates species response parameters for n dimensions
 — species • palaeoSig</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generates species response parameters for n dimensions
 — species"><meta property="og:description" content="Generates species response parameters to n environmental variables following Minchin (1987). 
"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">palaeoSig</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/h-block-crossvalidation.html">H-block cross-validation</a>
    </li>
    <li>
      <a href="../articles/randomTF-spatial.html">randomTF on spatially structured environments</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/richardjtelford/palaeoSig/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates species response parameters for n dimensions
<!-- %%  ~~function to do ... ~~ --></h1>
    
    <div class="hidden name"><code>species.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates species response parameters to n environmental variables following Minchin (1987). 
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, <span class="va">Amax</span>, <span class="va">fun</span>, <span class="va">xpar</span>, <span class="va">srange</span>, alpha <span class="op">=</span> <span class="fl">4</span>, </span>
<span>        gamma<span class="op">=</span> <span class="fl">4</span>, <span class="va">ndim</span>, <span class="va">sdistr</span>, <span class="va">ocor</span>, <span class="va">odistr</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>nspp</dt>
<dd><p>Number of species to be generated.
<!-- %%     ~~Describe \code{nspp} here~~ --></p></dd>

  <dt>Amax</dt>
<dd><p>Maximum abundance of a species. `Amax` currently allows three options: i) a function how to generate maximum abundances (e.g. `runif`, `rgamma`) ii) a vector of length `nspp`  iii) a single number that is used as maximum abundance for all the species.  
<!-- %%     ~~Describe \code{Amax} here~~ --></p></dd>

  <dt>fun</dt>
<dd><p>Function to generate species optima (e.g. `rnorm`, `runif`). The two parameters in `xpar` are passed to function `fun`. If omitted species optima are generated 
  at regular intervals between the two values in `xpar`.  
<!-- %%     ~~Describe \code{fun} here~~ --></p></dd>
   
<dt>xpar</dt>
<dd><p>Two numbers describing a distribution e.g mu and sigma for a normal distribution, lower and upper bound for a random uniform distribution. 
<!-- %%     ~~Describe \code{xpar} here~~ --></p></dd>

<dt>srange</dt>
<dd><p>Length of the ecological gradient to which individual species respond. Either one number or a matrix with `nspp` rows and `ndim` columns. If `srange` should be different for different environmental variables a simpler solution is to change argument elen in <code><a href="make.env.html">make.env</a></code> accordingly. E.g. `elen = c(100,50,50)` when using three environmental gradients.  
<!-- %%     ~~Describe \code{srange} here~~ --></p></dd>
    
<dt>alpha</dt>
<dd><p>Shape parameter of the beta distribution. One number or a matrix with `nspp` rows and `ndim` columns.
<!-- %%     ~~Describe \code{alpha} here~~ --></p></dd>

  <dt>gamma</dt>
<dd><p>Shape parameter of the beta distribution. One number or a matrix with `nspp` rows and `ndim` columns.
<!-- %%     ~~Describe \code{gamma} here~~ --></p></dd>

  <dt>ndim</dt>
<dd><p>Number of environmental variables to which generated species should respond.
<!-- %%     ~~Describe \code{ndim} here~~ --></p></dd>


  <dt>sdistr</dt>
<dd><p>Users may supply own distributions of species optima. Matrix with `nspp` rows and `ndim` columns (as well in the special case of `ndim = 1`).  
<!-- %%     ~~Describe \code{sdistr} here~~ --></p></dd>


  <dt>ocor</dt>
<dd><p>Correlation matrix of the species optima. May be generated by code <a href="cor.mat.fun.html">cor.mat.fun</a>. 
<!-- %%     ~~Describe \code{ocor} here~~ --></p></dd>

  <dt>odistr</dt>
<dd><p>Distribution of the correlated optima either 'uniform' or 'Gaussian'
<!-- %%     ~~Describe \code{odistr} here~~ --></p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Details on the exact generation of species response functions from parameters `Amax`, `m`, `r`, `gamma` and `alpha` are given in Minchin (1987). Species response curves are determined by five parameters: a parameter determining the maximum abundance (`Amax`) and one describing the location (`m`) of this mode. A parameter determining to which environmental range the species respond (`srange` in the input `r` in the output) and two parameters (`alpha`, `gamma`) describing the shape of the species response function. If `alpha` = `gamma` the response curve is symmetric (`alpha` = `gamma` = 4, yields Gaussian distributions). Additionally, species optima for several environmental variables may be correlated. Currently this is only possible for gaussian or uniform distributions of species optima. Users may as well supply previously generated optima (e.g. optima similar to a real dataset).</p>
<p><!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>List with `ndim` elements. Each list contains the species response parameters to one environmental gradient.     
<!-- %%  ~Describe the value returned --></p>


<p><!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


    </div>
    <div id="references">
    <h2>References</h2>
    <p>Minchin, P.R. (1987) Multidimensional Community Patterns: Towards a Comprehensive Model. Vegetatio, 71, 145-156.
<!-- %% ~put references to the literature/web site here ~ --></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mathias Trachsel and Richard J. Telford
<!-- %%  ~~who you are~~ --></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, Amax <span class="op">=</span> <span class="va">runif</span>, srange <span class="op">=</span> <span class="fl">200</span>, fun <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>ndim <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">4</span>, gamma <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, ndim <span class="op">=</span> <span class="fl">3</span>, Amax <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>srange <span class="op">=</span> <span class="fl">200</span>, alpha <span class="op">=</span> <span class="fl">4</span>, gamma <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example where srange, alpha and gamma are different for each species and environmental gradient. </span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, ndim <span class="op">=</span> <span class="fl">3</span>, Amax <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>srange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example where species optima are correlated</span></span></span>
<span class="r-in"><span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec.cor.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="cor.mat.fun.html">cor.mat.fun</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">correlations</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, ndim <span class="op">=</span> <span class="fl">3</span>, Amax <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, srange <span class="op">=</span> <span class="fl">200</span>, </span></span>
<span class="r-in"><span>alpha <span class="op">=</span> <span class="fl">4</span>, gamma <span class="op">=</span> <span class="fl">4</span>,ocor <span class="op">=</span> <span class="va">spec.cor.mat</span>, odistr <span class="op">=</span> <span class="st">'Gaussian'</span><span class="op">)</span>           </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example for species response curves (users should alter alpha and gamma)</span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">1</span>, Amax <span class="op">=</span> <span class="fl">200</span>, srange <span class="op">=</span> <span class="fl">200</span>, fun <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>    ndim <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">50</span><span class="op">:</span><span class="fl">150</span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">palaeoSig</span><span class="fu">:::</span><span class="fu">make.abundances</span><span class="op">(</span>env <span class="op">=</span> <span class="op">-</span><span class="fl">50</span><span class="op">:</span><span class="fl">150</span>, param <span class="op">=</span> <span class="va">spec.par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">spp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">env</span>, <span class="va">response</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="species-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>                                                                                                       </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard Telford.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

