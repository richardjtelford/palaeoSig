<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generates species response parameters for n dimensions  — species • palaeoSig</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generates species response parameters for n dimensions  — species"><meta name="description" content="Generates species response parameters to n environmental variables following Minchin (1987).
"><meta property="og:description" content="Generates species response parameters to n environmental variables following Minchin (1987).
"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoSig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/h-block-crossvalidation.html">H-block cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/randomTF-spatial.html">randomTF on spatially structured environments</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/richardjtelford/palaeoSig/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generates species response parameters for n dimensions <!-- %% ~~function to do ... ~~ --></h1>

      <div class="d-none name"><code>species.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates species response parameters to n environmental variables following Minchin (1987).
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, <span class="va">Amax</span>, <span class="va">fun</span>, <span class="va">xpar</span>, <span class="va">srange</span>, alpha <span class="op">=</span> <span class="fl">4</span>, </span>
<span>        gamma<span class="op">=</span> <span class="fl">4</span>, <span class="va">ndim</span>, <span class="va">sdistr</span>, <span class="va">ocor</span>, <span class="va">odistr</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-nspp">nspp<a class="anchor" aria-label="anchor" href="#arg-nspp"></a></dt>
<dd><p>Number of species to be generated.
<!-- %%     ~~Describe \code{nspp} here~~ --></p></dd>

  <dt id="arg-amax">Amax<a class="anchor" aria-label="anchor" href="#arg-amax"></a></dt>
<dd><p>Maximum abundance of a species. `Amax` currently allows three options: i) a function how to generate maximum abundances (e.g. `runif`, `rgamma`) ii) a vector of length `nspp`  iii) a single number that is used as maximum abundance for all the species.
<!-- %%     ~~Describe \code{Amax} here~~ --></p></dd>

  <dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Function to generate species optima (e.g. `rnorm`, `runif`). The two parameters in `xpar` are passed to function `fun`. If omitted species optima are generated
  at regular intervals between the two values in `xpar`.
<!-- %%     ~~Describe \code{fun} here~~ --></p></dd>

<dt id="arg-xpar">xpar<a class="anchor" aria-label="anchor" href="#arg-xpar"></a></dt>
<dd><p>Two numbers describing a distribution e.g mu and sigma for a normal distribution, lower and upper bound for a random uniform distribution.
<!-- %%     ~~Describe \code{xpar} here~~ --></p></dd>

<dt id="arg-srange">srange<a class="anchor" aria-label="anchor" href="#arg-srange"></a></dt>
<dd><p>Length of the ecological gradient to which individual species respond. Either one number or a matrix with `nspp` rows and `ndim` columns. If `srange` should be different for different environmental variables a simpler solution is to change argument elen in <code><a href="make.env.html">make.env</a></code> accordingly. E.g. `elen = c(100,50,50)` when using three environmental gradients.
<!-- %%     ~~Describe \code{srange} here~~ --></p></dd>

<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Shape parameter of the beta distribution. One number or a matrix with `nspp` rows and `ndim` columns.
<!-- %%     ~~Describe \code{alpha} here~~ --></p></dd>

  <dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Shape parameter of the beta distribution. One number or a matrix with `nspp` rows and `ndim` columns.
<!-- %%     ~~Describe \code{gamma} here~~ --></p></dd>

  <dt id="arg-ndim">ndim<a class="anchor" aria-label="anchor" href="#arg-ndim"></a></dt>
<dd><p>Number of environmental variables to which generated species should respond.
<!-- %%     ~~Describe \code{ndim} here~~ --></p></dd>


  <dt id="arg-sdistr">sdistr<a class="anchor" aria-label="anchor" href="#arg-sdistr"></a></dt>
<dd><p>Users may supply own distributions of species optima. Matrix with `nspp` rows and `ndim` columns (as well in the special case of `ndim = 1`).
<!-- %%     ~~Describe \code{sdistr} here~~ --></p></dd>


  <dt id="arg-ocor">ocor<a class="anchor" aria-label="anchor" href="#arg-ocor"></a></dt>
<dd><p>Correlation matrix of the species optima. May be generated by code <a href="cor.mat.fun.html">cor.mat.fun</a>.
<!-- %%     ~~Describe \code{ocor} here~~ --></p></dd>

  <dt id="arg-odistr">odistr<a class="anchor" aria-label="anchor" href="#arg-odistr"></a></dt>
<dd><p>Distribution of the correlated optima either 'uniform' or 'Gaussian'
<!-- %%     ~~Describe \code{odistr} here~~ --></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Details on the exact generation of species response functions from parameters `Amax`, `m`, `r`, `gamma` and `alpha` are given in Minchin (1987). Species response curves are determined by five parameters: a parameter determining the maximum abundance (`Amax`) and one describing the location (`m`) of this mode. A parameter determining to which environmental range the species respond (`srange` in the input `r` in the output) and two parameters (`alpha`, `gamma`) describing the shape of the species response function. If `alpha` = `gamma` the response curve is symmetric (`alpha` = `gamma` = 4, yields Gaussian distributions). Additionally, species optima for several environmental variables may be correlated. Currently this is only possible for gaussian or uniform distributions of species optima. Users may as well supply previously generated optima (e.g. optima similar to a real dataset).</p>
<p><!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with `ndim` elements. Each list contains the species response parameters to one environmental gradient.
<!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use -->
<!-- %%  \item{comp1 }{Description of 'comp1'} -->
<!-- %%  \item{comp2 }{Description of 'comp2'} -->
<!-- %% ... --></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Minchin, P.R. (1987) Multidimensional Community Patterns: Towards a Comprehensive Model. Vegetatio, 71, 145-156.
<!-- %% ~put references to the literature/web site here ~ --></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mathias Trachsel and Richard J. Telford
<!-- %%  ~~who you are~~ --></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, Amax <span class="op">=</span> <span class="va">runif</span>, srange <span class="op">=</span> <span class="fl">200</span>, fun <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>ndim <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">4</span>, gamma <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, ndim <span class="op">=</span> <span class="fl">3</span>, Amax <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>srange <span class="op">=</span> <span class="fl">200</span>, alpha <span class="op">=</span> <span class="fl">4</span>, gamma <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example where srange, alpha and gamma are different for each species and environmental gradient. </span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, ndim <span class="op">=</span> <span class="fl">3</span>, Amax <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>srange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example where species optima are correlated</span></span></span>
<span class="r-in"><span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec.cor.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="cor.mat.fun.html">cor.mat.fun</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">correlations</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">30</span>, ndim <span class="op">=</span> <span class="fl">3</span>, Amax <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, srange <span class="op">=</span> <span class="fl">200</span>, </span></span>
<span class="r-in"><span>alpha <span class="op">=</span> <span class="fl">4</span>, gamma <span class="op">=</span> <span class="fl">4</span>,ocor <span class="op">=</span> <span class="va">spec.cor.mat</span>, odistr <span class="op">=</span> <span class="st">'Gaussian'</span><span class="op">)</span>           </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example for species response curves (users should alter alpha and gamma)</span></span></span>
<span class="r-in"><span><span class="va">spec.par</span> <span class="op">&lt;-</span> <span class="fu">species</span><span class="op">(</span>nspp <span class="op">=</span> <span class="fl">1</span>, Amax <span class="op">=</span> <span class="fl">200</span>, srange <span class="op">=</span> <span class="fl">200</span>, fun <span class="op">=</span> <span class="va">runif</span>, xpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>    ndim <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">50</span><span class="op">:</span><span class="fl">150</span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">palaeoSig</span><span class="fu">:::</span><span class="fu">make.abundances</span><span class="op">(</span>env <span class="op">=</span> <span class="op">-</span><span class="fl">50</span><span class="op">:</span><span class="fl">150</span>, param <span class="op">=</span> <span class="va">spec.par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">spp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">env</span>, <span class="va">response</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="species-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>                                                                                                       </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Telford.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

